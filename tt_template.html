<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .days {
            background-color: blue;
            color: aliceblue;
        }

        .timings {
            background-color: red;
            color: yellow;
        }

        td {
            width: 100px;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .heading {
            background-color: black;
            color: white;
        }
    </style>
</head>

<body>
    <table class="seg-12 seg-14 seg-16" style="text-align: center;">
        <h1 class="heading">Segment 1-2</h1>
        <tr>
            <td></td>
            <td class="timings">09:00 - 09:55</td>
            <td class="timings">10:00 - 10:55</td>
            <td class="timings">11:00 - 11:55</td>
            <td class="timings">12:00 - 12:55</td>
            <td class="timings">14:30 - 15:55</td>
            <td class="timings">16:00 - 17:25</td>
            <td class="timings">17:30 - 19:00</td>
            <td class="timings">19:00 - 20:30</td>

        </tr>
        <tr>
            <td class="days">Monday</td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="D"></td>
            <td class="P"></td>
            <td class="Q"></td>
            <td class="W"></td>
            <td class="X"></td>
        </tr>
        <tr>
            <td class="days">Tuesday</td>
            <td class="D"></td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="G"></td>
            <td class="R"></td>
            <td class="S"></td>
            <td class="Y"></td>
            <td class="Z"></td>
        </tr>
        <tr>
            <td class="days">Wednesday</td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="G"></td>
            <td class="F"></td>
            <td class="Challenge_Lectures"></td>
            <td class=""></td>
            <td class=""></td>
        </tr>
        <tr>
            <td class="days">Thursday</td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="E"></td>
            <td class="Q"></td>
            <td class="P"></td>
            <td class="W"></td>
            <td class="X"></td>
        </tr>
        <tr>
            <td class="days">Friday</td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="D"></td>
            <td class="G"></td>
            <td class="S"></td>
            <td class="R"></td>
            <td class="Y"></td>
            <td class="Z"></td>
        </tr>
    </table>
    <table class="seg-14 seg-34 seg-36 seg-16" style="text-align: center;">
        <h1 class="heading">Segment 3-4</h1>
        <tr>
            <td></td>
            <td class="timings">09:00 - 09:55</td>
            <td class="timings">10:00 - 10:55</td>
            <td class="timings">11:00 - 11:55</td>
            <td class="timings">12:00 - 12:55</td>
            <td class="timings">14:30 - 15:55</td>
            <td class="timings">16:00 - 17:25</td>
            <td class="timings">17:30 - 19:00</td>
            <td class="timings">19:00 - 20:30</td>

        </tr>
        <tr>
            <td class="days">Monday</td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="D"></td>
            <td class="P"></td>
            <td class="Q"></td>
            <td class="W"></td>
            <td class="X"></td>
        </tr>
        <tr>
            <td class="days">Tuesday</td>
            <td class="D"></td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="G"></td>
            <td class="R"></td>
            <td class="S"></td>
            <td class="Y"></td>
            <td class="Z"></td>
        </tr>
        <tr>
            <td class="days">Wednesday</td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="G"></td>
            <td class="F"></td>
            <td class="Challenge_Lectures"></td>
            <td class=""></td>
            <td class=""></td>
        </tr>
        <tr>
            <td class="days">Thursday</td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="E"></td>
            <td class="Q"></td>
            <td class="P"></td>
            <td class="W"></td>
            <td class="X"></td>
        </tr>
        <tr>
            <td class="days">Friday</td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="D"></td>
            <td class="G"></td>
            <td class="S"></td>
            <td class="R"></td>
            <td class="Y"></td>
            <td class="Z"></td>
        </tr>
    </table>
    <table class="seg-16 seg-36 seg-56" style="text-align: center;">
        <h1 class="heading">Segment 5-6</h1>
        <tr>
            <td></td>
            <td class="timings">09:00 - 09:55</td>
            <td class="timings">10:00 - 10:55</td>
            <td class="timings">11:00 - 11:55</td>
            <td class="timings">12:00 - 12:55</td>
            <td class="timings">14:30 - 15:55</td>
            <td class="timings">16:00 - 17:25</td>
            <td class="timings">17:30 - 19:00</td>
            <td class="timings">19:00 - 20:30</td>

        </tr>
        <tr>
            <td class="days">Monday</td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="D"></td>
            <td class="P"></td>
            <td class="Q"></td>
            <td class="W"></td>
            <td class="X"></td>
        </tr>
        <tr>
            <td class="days">Tuesday</td>
            <td class="D"></td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="G"></td>
            <td class="R"></td>
            <td class="S"></td>
            <td class="Y"></td>
            <td class="Z"></td>
        </tr>
        <tr>
            <td class="days">Wednesday</td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="G"></td>
            <td class="F"></td>
            <td class="Challenge_Lectures"></td>
            <td class=""></td>
            <td class=""></td>
        </tr>
        <tr>
            <td class="days">Thursday</td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="E"></td>
            <td class="Q"></td>
            <td class="P"></td>
            <td class="W"></td>
            <td class="X"></td>
        </tr>
        <tr>
            <td class="days">Friday</td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="D"></td>
            <td class="G"></td>
            <td class="S"></td>
            <td class="R"></td>
            <td class="Y"></td>
            <td class="Z"></td>
        </tr>
    </table><br><br>
    <button onclick="exportTableToExcel('time-table')">Download as Excel</button>
    <script>
        const slotColors = {
            A: 'blue',
            B: 'green',
            C: 'yellow',
            D: 'coral',
            E: 'pink',
            F: 'seagreen',
            G: 'goldenrodyellow',
            P: 'gray',
            Q: 'green',
            R: 'yellow',
            S: 'red',
            W: 'salmon',
            X: 'steelblue',
            Y: 'green',
            Z: 'blue',
            Challenge_Lectures: 'lightgray', // Add more slot colors as needed
        };

        const jsonUrl = 'timetable.schedules.json';
        function renderTimeTable(data) {
            // Loop through the data and populate the table
            data.forEach(item => {
                const segTables = document.querySelectorAll(`.seg-${item.seg}`);
                segTables.forEach(segTable => {
                    if (segTable) {
                        const dayRows = segTable.querySelectorAll('tr');

                        dayRows.forEach(dayRow => {
                            const slotCells = dayRow.querySelectorAll(`td.${item.slot}`);
                            slotCells.forEach(slotCell => {
                                slotCell.style.backgroundColor = item.courseName ? (slotColors[item.slot] || 'white') : 'white'; // Default to white if no color is defined
                                slotCell.innerHTML = `
                    <strong>${item.courseName}</strong><br>                   
                    ${item.venue}
                `;
                            });
                        });
                    }
                })

            });
        }
        fetch(jsonUrl)
        .then(response => {
            if(!response.ok){
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data=>{
            renderTimeTable(data);
        })
        .catch(error=>{
            console.error("Error while fetching the time table:",error);
        });

        // Call the renderTimeTable datafunction when the page loads
        window.onload = renderTimeTable;data


    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="convert.js"></script>
</body>

</html>