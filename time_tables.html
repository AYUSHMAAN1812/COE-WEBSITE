<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>COE-WEBSITE - Time Tables</title>
  <link href="assets/images/iithlogo.png" rel="icon" />
  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <link href="assets/css/styles.css" rel="stylesheet" />
  <style>
    /* Custom styling */
    h4 {
      text-align: center;
      margin-bottom: 20px;
    }

    .div-4 {
      padding-top: 25px;
    }

    table,
    td,
    th,
    thead {
      border: 1px solid rgb(112, 112, 112);
    }

    thead th {
      font-weight: 600;
      font-size: large;
      background-color: rgb(69, 69, 69) !important;
      color: white !important;
    }

    table {
      margin-bottom: 30px;
    }

    .table_container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-top: 20px;
    }

    #sheet-menu {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
    }

    #sheet-menu li {
      display: inline-block;
      padding: 10px 20px;
      background-color: #ddd;
      margin-right: 5px;
      cursor: pointer;
      border-radius: 5px;
    }

    #sheet-menu li.active {
      background-color: #333;
      color: white;
    }

    .downloadBtn {
      margin-bottom: 30px;
      padding: 10px 20px;
      background-color: #218838;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }

    .downloadBtn:hover {
      background-color: #218838;
    }

    #doc-title {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
    }

    /* Timetable template styles */
    .heading {
      background-color: black;
      color: white;
      margin-bottom: 5px;
    }

    .timings {
      background-color: red;
      color: yellow;
    }

    .days {
      background-color: blue;
      color: aliceblue;
    }

    td {
      width: 100px;
    }

    #time-table {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }


    /* Hide desktop content for smaller screens */
    @media (max-width: 1199px) {
      .desktopMode {
        display: none;
      }

    }
  </style>
</head>

<body>
  <!-- Your header component -->
  <my-header></my-header>

  <div id="top-nav">
    <div id="doc-title">
      <span>Time_Tables (2024-25)</span>
    </div>
    <ul id="sheet-menu">
      <li data-semester="sem1" class="active"><a href="#">Sem-1</a></li>
      <li data-semester="sem2"><a href="#">Sem-2</a></li>
      <li data-semester="sem3"><a href="#">Sem-3</a></li>
      <li data-semester="sem4"><a href="#">Sem-4</a></li>
      <li data-semester="sem5"><a href="#">Sem-5</a></li>
      <li data-semester="sem6"><a href="#">Sem-6</a></li>
      <li data-semester="sem7"><a href="#">Sem-7</a></li>
      <li data-semester="sem8"><a href="#">Sem-8</a></li>
      <!-- Add more tabs if needed -->
    </ul>
  </div>

  <!-- Container where the timetable template is inserted -->
  <div class="table_container" id="table_container">
    <!-- The timetable template will be injected here -->
  </div>
  <my-footer></my-footer>
  <script src="footer.js"></script>
  <!-- Timetable template as a JavaScript string -->
  <script>
    // A string that contains the timetable structure (three segment tables)
    const timetableTemplate = `
      <div id="time-table">
        <table class="seg-12 seg-14 seg-16 desktopMode" style="text-align: center;">
          <h1 class="heading desktopMode">Segment 1-2</h1>
          <tr>
            <td></td>
            <td class="timings">09:00 - 09:55</td>
            <td class="timings">10:00 - 10:55</td>
            <td class="timings">11:00 - 11:55</td>
            <td class="timings">12:00 - 12:55</td>
            <td class="timings">14:30 - 15:55</td>
            <td class="timings">16:00 - 17:25</td>
            <td class="timings">17:30 - 19:00</td>
            <td class="timings">19:00 - 20:30</td>
          </tr>
          <tr>
            <td class="days">Monday</td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="D"></td>
            <td class="P"></td>
            <td class="Q"></td>
            <td class="W"></td>
            <td class="X"></td>
          </tr>
          <tr>
            <td class="days">Tuesday</td>
            <td class="D"></td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="G"></td>
            <td class="R"></td>
            <td class="S"></td>
            <td class="Y"></td>
            <td class="Z"></td>
          </tr>
          <tr>
            <td class="days">Wednesday</td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="G"></td>
            <td class="F"></td>
            <td class="Challenge_Lectures"></td>
            <td class=""></td>
            <td class=""></td>
          </tr>
          <tr>
            <td class="days">Thursday</td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="E"></td>
            <td class="Q"></td>
            <td class="P"></td>
            <td class="W"></td>
            <td class="X"></td>
          </tr>
          <tr>
            <td class="days">Friday</td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="D"></td>
            <td class="G"></td>
            <td class="S"></td>
            <td class="R"></td>
            <td class="Y"></td>
            <td class="Z"></td>
          </tr>
        </table>

        <table class="seg-14 seg-34 seg-36 seg-16 desktopMode" style="text-align: center;">
          <h1 class="heading desktopMode">Segment 3-4</h1>
          <tr>
            <td></td>
            <td class="timings">09:00 - 09:55</td>
            <td class="timings">10:00 - 10:55</td>
            <td class="timings">11:00 - 11:55</td>
            <td class="timings">12:00 - 12:55</td>
            <td class="timings">14:30 - 15:55</td>
            <td class="timings">16:00 - 17:25</td>
            <td class="timings">17:30 - 19:00</td>
            <td class="timings">19:00 - 20:30</td>
          </tr>
          <tr>
            <td class="days">Monday</td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="D"></td>
            <td class="P"></td>
            <td class="Q"></td>
            <td class="W"></td>
            <td class="X"></td>
          </tr>
          <tr>
            <td class="days">Tuesday</td>
            <td class="D"></td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="G"></td>
            <td class="R"></td>
            <td class="S"></td>
            <td class="Y"></td>
            <td class="Z"></td>
          </tr>
          <tr>
            <td class="days">Wednesday</td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="G"></td>
            <td class="F"></td>
            <td class="Challenge_Lectures"></td>
            <td class=""></td>
            <td class=""></td>
          </tr>
          <tr>
            <td class="days">Thursday</td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="E"></td>
            <td class="Q"></td>
            <td class="P"></td>
            <td class="W"></td>
            <td class="X"></td>
          </tr>
          <tr>
            <td class="days">Friday</td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="D"></td>
            <td class="G"></td>
            <td class="S"></td>
            <td class="R"></td>
            <td class="Y"></td>
            <td class="Z"></td>
          </tr>
        </table>

        <table class="seg-16 seg-36 seg-56 desktopMode" style="text-align: center;">
          <h1 class="heading desktopMode">Segment 5-6</h1>
          <tr>
            <td></td>
            <td class="timings">09:00 - 09:55</td>
            <td class="timings">10:00 - 10:55</td>
            <td class="timings">11:00 - 11:55</td>
            <td class="timings">12:00 - 12:55</td>
            <td class="timings">14:30 - 15:55</td>
            <td class="timings">16:00 - 17:25</td>
            <td class="timings">17:30 - 19:00</td>
            <td class="timings">19:00 - 20:30</td>
          </tr>
          <tr>
            <td class="days">Monday</td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="D"></td>
            <td class="P"></td>
            <td class="Q"></td>
            <td class="W"></td>
            <td class="X"></td>
          </tr>
          <tr>
            <td class="days">Tuesday</td>
            <td class="D"></td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="G"></td>
            <td class="R"></td>
            <td class="S"></td>
            <td class="Y"></td>
            <td class="Z"></td>
          </tr>
          <tr>
            <td class="days">Wednesday</td>
            <td class="B"></td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="G"></td>
            <td class="F"></td>
            <td class="Challenge_Lectures"></td>
            <td class=""></td>
            <td class=""></td>
          </tr>
          <tr>
            <td class="days">Thursday</td>
            <td class="C"></td>
            <td class="A"></td>
            <td class="B"></td>
            <td class="E"></td>
            <td class="Q"></td>
            <td class="P"></td>
            <td class="W"></td>
            <td class="X"></td>
          </tr>
          <tr>
            <td class="days">Friday</td>
            <td class="E"></td>
            <td class="F"></td>
            <td class="D"></td>
            <td class="G"></td>
            <td class="S"></td>
            <td class="R"></td>
            <td class="Y"></td>
            <td class="Z"></td>
          </tr>
        </table>
        <br><br>
        <button class="downloadBtn " onclick="exportTableToExcel('time-table')">Download as Excel</button>
      </div>
    `;
  </script>

  <!-- JavaScript to switch semesters and render timetable data -->
  <script>
    let currentSemester = 'sem1';
    let timetableData = [];
    // Define slot colors
    const slotColors = {
      A: 'blue',
      B: 'green',
      C: 'yellow',
      D: 'coral',
      E: 'pink',
      F: 'seagreen',
      G: 'goldenrodyellow',
      P: 'gray',
      Q: 'green',
      R: 'yellow',
      S: 'red',
      W: 'salmon',
      X: 'steelblue',
      Y: 'green',
      Z: 'blue',
      Challenge_Lectures: 'lightgray'
      // Add more slot colors if needed
    };

    const tableContainer = document.getElementById('table_container');

    // Function to inject the timetable template and render the data for currentSemester
    function loadTimetable() {
      tableContainer.innerHTML = timetableTemplate;
      // After injecting the template, fill in the data for the current semester
      renderTimeTableForSemester(currentSemester);
    }

    // Function to render timetable data for a specific semester
    function renderTimeTableForSemester(semester) {
      // Filter data for the selected semester
      const filteredData = timetableData.filter(item => item.semester === semester);
      filteredData.forEach(item => {
        // Find tables inside the timetable container that match the segment class (e.g. seg-12, seg-14, etc.)
        const segTables = document.querySelectorAll(`#time-table .seg-${item.seg}`);
        segTables.forEach(segTable => {
          // Find table cells with the class corresponding to the slot (e.g. A, B, etc.)
          const slotCells = segTable.querySelectorAll(`td.${item.slot}`);
          slotCells.forEach(slotCell => {
            // Fill the cell with course name and venue, and set background color
            if (item.courseName) {
              slotCell.style.backgroundColor = slotColors[item.slot] || 'white';
              slotCell.innerHTML = `<strong>${item.courseName}</strong><br>${item.venue}`;
            }
          });
        });
      });
    }

    // Fetch timetable schedule JSON only once
    fetch('timetable.schedules.json')
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then(data => {
        timetableData = data;
        loadTimetable();
      })
      .catch(error => {
        console.error("Error while fetching the timetable data:", error);
      });

    // Handle semester tab switching
    document.querySelectorAll('#sheet-menu li').forEach(item => {
      item.addEventListener('click', function () {
        // Remove 'active' class from all tabs and add to clicked tab
        document.querySelectorAll('#sheet-menu li').forEach(tab => tab.classList.remove('active'));
        this.classList.add('active');
        // Update currentSemester from the data-semester attribute
        currentSemester = this.getAttribute('data-semester');
        // Reload timetable template and render data for the selected semester
        loadTimetable();
      });
    });

    // Dummy export function – you can replace this with your actual Excel conversion code.
    function exportTableToExcel(tableID) {
      alert("Export to Excel functionality triggered for table: " + tableID);
      // Your conversion code from convert.js or other library can go here.
    }
  </script>

  <script src="header.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="convert.js"></script>
</body>

</html>